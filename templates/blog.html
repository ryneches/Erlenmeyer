{% extends "layout.html" %}
{% block body %}

<div class="row">
    <div class="col-md-3" id="leftCol">
        <ul class="nav nav-stacked" id="sidebar">
        {% for r in articles %}
            <li><a href="#sec{{ r.id }}">{{ r.headline }}</a></li>
        {% endfor %}
        </ul>
    </div>
    <div class="col-md-9">

{% for r in articles %}
    {% if r.active %}
        <div class="well erlenmeyer-article">
        <h1 id="sec{{ r.id }}"><a href="{{ r.url }}">{{ r.headline }}</a></h1>
        <div class="article-markdown">
        {{ r.html }}
        </div>
        <hr/>
        <div class="media">
        <a class="pull-left" href="/user/{{ r.username }}">
        <img class="img-circle media-object" src="{{ url_for( 'static', filename=r.thumb ) }}">
        </a>
        <div class="media-body">
            <h4 class="media-heading">
            Posted by <a href="/user/{{ r.username}}">{{ r.realname }}</a>
            </h4>
            on <a href="/{{ r.year }}/{{ r.month}}/{{ r.day }}">{{ r.day }}</a>/<a href="/{{ r.year }}/{{ r.month }}">{{ r.month }}</a>/<a href="/{{ r.year }}">{{ r.year }}</a> at {{ r.hour }}:{{ r.minute }}</h4>
            under a Creative Commons Attributuion License.
            <p>
            <a href="http://creativecommons.org/licenses/by/3.0/us/">
            <img src="/static/img/by.svg">
            </a>
            <p>
        </div>
        </div>
        </div>
        {% if comments %}
            {% block comments %}
            {% endblock %} 
        {% endif %}
    {% endif %}
{% endfor %}

    </div>
</div>

<script type="text/javascript">
    $.getJSON( $SCRIPT_ROOT + '/summary',  function(data) { 
        $.each( data, function( key, val ) {
            var year = key;
            var navyear = "<li><a href=\"\">" + year + "<ul class=\"nav\"id=\"#nav-year" + year + "\">"

            $.each( val, function( key, val ) {
                var month = key;
                navyear = navyear + "<li><a href=\"\">" + month + "</a><ul class=\"nav\">"
                $.each( val, function( key, val ) {
                    console.log( year, month, val.slug );
                    navyear = navyear + "<li><a href=\"\">" + val.headline + "</a></li>"
                } );
                navyear = navyear + "</ul></li>"
            } );

            navyear = navyear + "</ul></li>"
            $("#sidebar").append( navyear );
        } ); 
    } );
</script>

{% endblock %}
